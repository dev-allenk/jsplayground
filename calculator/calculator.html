<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>계산기</title>
</head>
<body>
    <h1>계산기 구현 연습</h1>
    <p>객체를 활용한 계산기 구현</p>
    <input id="input" type="text"><br>
    <button onclick="one()">1</button>
    <button onclick="two()">2</button>
    <button onclick="three()">3</button>
    <button onclick="plus()">+</button><br>
    <button onclick="four()">4</button>
    <button onclick="five()">5</button>
    <button onclick="six()">6</button>
    <button onclick="minus()">-</button><br>
    <button onclick="seven()">7</button>
    <button onclick="eight()">8</button>
    <button onclick="nine()">9</button>
    <button onclick="multiple()">*</button><br>
    <button onclick="zero()">0</button>
    <button onclick="division()">/</button>
    <button id="button" onclick="main()">계산</button>
    <div id="formula"></div>
    <div id="output"></div>

    <script>
        function one() {
            var i = document.getElementById('input')
            i.value += '1';
        }
        function two() {
            var i = document.getElementById('input')
            i.value += '2';
        }
        function three() {
            var i = document.getElementById('input')
            i.value += '3';
        }
        function four() {
            var i = document.getElementById('input')
            i.value += '4';
        }
        function five() {
            var i = document.getElementById('input')
            i.value += '5';
        }
        function six() {
            var i = document.getElementById('input')
            i.value += '6';
        }
        function seven() {
            var i = document.getElementById('input')
            i.value += '7';
        }
        function eight() {
            var i = document.getElementById('input')
            i.value += '8';
        }
        function nine() {
            var i = document.getElementById('input')
            i.value += '9';
        }
        function zero() {
            var i = document.getElementById('input')
            i.value += '0';
        }
        function plus() {
            var i = document.getElementById('input')
            i.value += '+';
        }
        function minus() {
            var i = document.getElementById('input')
            i.value += '-';
        }
        function multiple() {
            var i = document.getElementById('input')
            i.value += '*';
        }
        function division() {
            var i = document.getElementById('input')
            i.value += '/';
        }

        var input = {
                all: [],
                operator: [],
                numbers: [],
                tempNumbers: []
            };

        input.readInput = function() {
            var in1 = document.getElementById('input').value;
            this.all = in1.split("");
            return this.all;
        };

        input.seperate = function() {
            for(var i = 0; i < this.all.length; i++) {
                if(this.all[i + 1] === '+' || this.all[i + 1] === '-' || this.all[i + 1] === '*' || this.all[i + 1] === '/') { // 2.연산자 앞의 숫자가 나오면 거기까지 한 숫자 이므로 join으로 합친 후 배열로 분리
                    this.tempNumbers.push(this.all[i]);
                    this.numbers.push(this.tempNumbers.join(""));
                    this.tempNumbers = [];
                } else if(this.all[i] === '+' || this.all[i] === '-' || this.all[i] === '*' || this.all[i] === '/') { // 3. 연산자는 따로 분리
                    this.operator.push(this.all[i]);
                } else { // 1. 연산자 나오기 전까지 숫자 임시 보관
                    this.tempNumbers.push(this.all[i]);
                } 
            }
            this.numbers.push(this.tempNumbers.join("")); // 마지막 남은 숫자 합쳐서 madeNum으로 push
        };
        
        input.getValue = function() {
            var n = Number(this.numbers.shift());
            return n;
        };

        input.getOperator = function() {
            var op = this.operator.shift();
            return op;
        };

        var calc = {};
        calc.calculate = function(first, second, operator) {
            var ret;
            if(operator === '+') {
                ret = first + second;
            } else if(operator === '-') {
                ret = first - second;
            } else if(operator === '*') {
                ret = first * second;
            } else if(operator === '/') {
                ret = first / second;
            }
            return ret;
        };

        var output = {};
        output.print = function(value) {
            return "결과값 : " + value;
        };

        function main() {
            input.readInput();
            input.seperate();
            var result = input.getValue();
            while(input.operator.length != 0) {
                var op = input.getOperator();
                var num = input.getValue();
                result = calc.calculate(result, num, op);
            }
            var out = document.getElementById('output');
            out.innerHTML = output.print(result);
        }

    </script>
</body>
</html>